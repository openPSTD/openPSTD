language: cpp
sudo: required
dist: trusty

matrix:
  include:
    - os: linux
      dist: trusty
      sudo: required
      env: TARGET=linux
    - os: linux
      dist: trusty
      sudo: required
      env: TARGET=windows
    - os: osx
      env: TARGET=osx
  allow_failures:
    - os: osx

env:
  global:
  - OPENPSTD_MAJOR_VERSION=2
  - OPENPSTD_MINOR_VERSION=0
  - WINTARGET=i686-w64-mingw32.static

before_install:
- sudo chmod -R +x build
- export PATH=./build/:$PATH
- export PATH=/opt/qt55/bin/:$PATH
- install_add_repo.sh

install:
- install_Qt55.sh
- install_boost.sh
- install_xsltproc.sh
- install_eigen.sh
- install_fftw.sh
- install_hdf5.sh

before_script:
- uname -r
- gcc -v
- cmake --version
- cmake --help
- cpack --version
- cpack --help
- ls -al /usr/lib/mxe/
- ls -al /usr/lib/mxe/usr/
- ls -al /usr/lib/mxe/usr/x86_64-w64-mingw32.static/
- ls -al /usr/lib/mxe/usr/x86_64-w64-mingw32.static/lib/

script:
- compile.sh
- test.sh

after_success:
- upload_webdav.sh
